/* ============================================
   ELEGANT PARTICLE SYSTEM STYLES
   Add to your existing CSS or create particles.css
   ============================================ */

/* Particle Canvas - Full Background Layer */
#particles {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  pointer-events: none;
  z-index: 1; /* Behind content but above background */
  opacity: 1;
  transition: opacity 0.5s ease;
  will-change: transform;
}

/* Canvas Performance - Cross-browser compatibility */
#particles {
  image-rendering: optimizeSpeed;
  image-rendering: -webkit-optimize-contrast;
  image-rendering: -moz-crisp-edges;
  image-rendering: crisp-edges;
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
  -moz-transform: translateZ(0);
  -ms-transform: translateZ(0);
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  -moz-backface-visibility: hidden;
  -ms-backface-visibility: hidden;
  /* Force hardware acceleration cross-platform */
  transform: translate3d(0, 0, 0);
  -webkit-transform: translate3d(0, 0, 0);
}

/* Parallax Container */
body {
  position: relative;
  overflow-x: hidden;
}

/* Scrolling State - Reduce particle opacity */
body.scrolling #particles {
  opacity: 0.6;
  transition: opacity 0.2s ease;
}

/* Loading Animation */
#particles.particles-loading {
  opacity: 0;
  animation: particleFadeIn 1.5s ease forwards;
  animation-delay: 0.3s;
}

@keyframes particleFadeIn {
  to {
    opacity: 1;
  }
}

/* ============================================
   DARK MODE PARTICLES
   ============================================ */
[data-theme="dark"] #particles {
  opacity: 1;
  mix-blend-mode: screen; /* Additive blending for glow effect */
  /* Fallback for browsers that don't support mix-blend-mode */
  filter: brightness(1.2) contrast(1.1);
  -webkit-filter: brightness(1.2) contrast(1.1);
}

/* Dark mode hero adjustments */
[data-theme="dark"] .hero {
  background: linear-gradient(180deg, 
    #0a0a0a 0%, 
    #0f0f0f 100%);
}

[data-theme="dark"] .hero-inner {
  background: linear-gradient(180deg, 
    rgba(255,255,255,0.03), 
    rgba(255,255,255,0.01));
  backdrop-filter: blur(24px) saturate(1.2);
  -webkit-backdrop-filter: blur(24px) saturate(1.2);
  -moz-backdrop-filter: blur(24px) saturate(1.2);
  -ms-backdrop-filter: blur(24px) saturate(1.2);
  border: 1px solid rgba(255,255,255,0.08);
  /* Fallback for browsers without backdrop-filter support */
  background-color: rgba(10, 10, 10, 0.85);
}

/* ============================================
   LIGHT MODE PARTICLES
   ============================================ */
[data-theme="light"] #particles {
  opacity: 0.7;
  mix-blend-mode: multiply; /* Darken blend for subtlety */
}

/* Light mode hero adjustments */
[data-theme="light"] .hero {
  background: linear-gradient(180deg, 
    #ffffff 0%, 
    #fafafa 100%);
}

[data-theme="light"] .hero-inner {
  background: linear-gradient(180deg, 
    rgba(255,255,255,0.95), 
    rgba(255,255,255,0.92));
  backdrop-filter: blur(20px) saturate(1.1);
  -webkit-backdrop-filter: blur(20px) saturate(1.1);
  -moz-backdrop-filter: blur(20px) saturate(1.1);
  -ms-backdrop-filter: blur(20px) saturate(1.1);
  border: 1px solid rgba(0,0,0,0.06);
  box-shadow: 
    0 20px 60px rgba(0,0,0,0.08),
    0 0 0 1px rgba(0,0,0,0.02);
  /* Fallback for browsers without backdrop-filter support */
  background-color: rgba(255, 255, 255, 0.9);
}

/* Safari-specific optimizations */
@supports (-webkit-backdrop-filter: blur()) {
  [data-theme="dark"] #particles {
    opacity: 0.4; /* Much lower opacity for Safari */
    mix-blend-mode: normal; /* Disable blend mode on Safari */
    filter: none; /* Remove filters on Safari */
    -webkit-filter: none;
  }
  
  [data-theme="light"] #particles {
    opacity: 0.3; /* Even lower for light mode */
    mix-blend-mode: normal;
  }
}

/* ============================================
   PARTICLE INTERACTION ZONES
   ============================================ */

/* Make hero content interactive above particles */
.hero-inner,
.nav,
.bot-fab,
.theme-toggle {
  position: relative;
  z-index: 10; /* Above particles */
}

/* Hero with particles background */
.hero {
  position: relative;
  z-index: 2;
  background: transparent; /* Let particles show through */
}

/* Ensure sections are above particles */
section {
  position: relative;
  z-index: 3;
  background: var(--bg-primary); /* Solid background for sections */
}

/* ============================================
   MOBILE OPTIMIZATIONS
   ============================================ */
@media (max-width: 768px) {
  #particles {
    opacity: 0.7; /* Reduced for performance */
  }
  
  [data-theme="dark"] #particles {
    opacity: 0.8;
  }
  
  [data-theme="light"] #particles {
    opacity: 0.6;
  }
  
  /* Reduce particles on scroll for mobile performance */
  body.scrolling #particles {
    opacity: 0.3;
    transition: opacity 0.15s ease;
  }
}

/* Small phones - further optimization */
@media (max-width: 375px) {
  #particles {
    opacity: 0.6;
  }
}

/* ============================================
   BROWSER-SPECIFIC FIXES
   ============================================ */

/* Chrome/WebKit specific fixes */
@supports (-webkit-appearance: none) {
  #particles {
    /* Chrome tends to render particles brighter */
    filter: brightness(0.9);
    -webkit-filter: brightness(0.9);
  }
  
  [data-theme="light"] #particles {
    /* Adjust for Chrome's light mode rendering */
    opacity: 0.6;
  }
}

/* Firefox specific fixes */
@-moz-document url-prefix() {
  #particles {
    /* Firefox rendering adjustments */
    opacity: 0.95;
  }
  
  [data-theme="dark"] #particles {
    mix-blend-mode: lighten; /* Alternative blend mode for Firefox */
  }
}

/* Edge/IE specific fixes */
@supports (-ms-accelerator: true) {
  #particles {
    /* Edge rendering adjustments */
    filter: contrast(1.1) brightness(1.05);
  }
  
  .hero-inner {
    /* Fallback background for older Edge */
    background: rgba(10, 10, 10, 0.9);
  }
}

/* Safari specific fixes */
@supports (-webkit-backdrop-filter: blur()) {
  .hero-inner {
    /* Safari handles backdrop-filter differently */
    -webkit-backdrop-filter: blur(20px) saturate(1.3);
  }
}

/* Cross-platform color consistency */
#particles {
  color-profile: sRGB;
  -webkit-color-profile: sRGB;
  /* Ensure consistent color rendering */
  image-rendering: -webkit-optimize-contrast;
  image-rendering: optimize-contrast;
}

/* ============================================
   PERFORMANCE & ACCESSIBILITY
   ============================================ */

/* Reduce motion preference - disable particles */
@media (prefers-reduced-motion: reduce) {
  #particles {
    display: none !important;
  }
  
  .hero-inner {
    background: linear-gradient(180deg, 
      rgba(255,255,255,0.05), 
      rgba(255,255,255,0.02));
  }
}

/* Low-end device detection */
@media (max-width: 768px) and (max-height: 600px) {
  #particles {
    opacity: 0.4;
  }
}

/* GPU acceleration hints */
.hero,
.hero-inner,
#particles {
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
  will-change: transform, opacity;
}

/* ============================================
   PARTICLE GLOW EFFECTS
   ============================================ */

/* Subtle glow behind hero card */
.hero-inner::before {
  content: '';
  position: absolute;
  inset: -50px;
  background: radial-gradient(
    circle at center,
    rgba(59, 130, 246, 0.05) 0%,
    transparent 70%
  );
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.5s ease;
  z-index: -1;
}

/* Activate glow on interaction */
.hero-inner:hover::before {
  opacity: 1;
}

/* ============================================
   SCROLL PARALLAX LAYERS
   ============================================ */

/* Define parallax layers */
.parallax-layer-1 {
  transform: translateZ(-1px) scale(1.1);
}

.parallax-layer-2 {
  transform: translateZ(-2px) scale(1.2);
}

.parallax-layer-3 {
  transform: translateZ(-3px) scale(1.3);
}

/* Smooth scroll behavior */
html {
  scroll-behavior: smooth;
}

/* Parallax container */
.parallax-container {
  height: 100vh;
  overflow-x: hidden;
  overflow-y: auto;
  perspective: 1px;
  transform-style: preserve-3d;
}

/* ============================================
   INTEGRATION WITH EXISTING ELEMENTS
   ============================================ */

/* Ensure nav stays above particles */
.nav {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 100;
  background: rgba(10, 10, 10, 0.9);
  backdrop-filter: blur(10px);
}

[data-theme="light"] .nav {
  background: rgba(255, 255, 255, 0.9);
}

/* Bot and theme toggle above particles */
.bot-fab,
.theme-toggle {
  z-index: 99;
}

/* Sections have solid backgrounds */
#work,
#labs,
#about,
#reading {
  background: var(--bg-primary);
  position: relative;
  z-index: 3;
}

/* Footer above particles */
footer {
  position: relative;
  z-index: 3;
  background: var(--bg-primary);
}
